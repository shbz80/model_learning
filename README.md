# Probabilistic Learning and Prediction of Contact-rich Manipulation Dynamics
This repo contains code for two cases: a simulated blocks experiment and also one with a real robot (YuMi) interacting with a rigid structure in its environment. The blocks experiment, in which a block of mass is acted upon by a linear policy and made to experience sudden changes in sliding dynamics, is considered as a simple test case of the model learning algorithm. The method is scaled up for the second experiment in which a YuMi robot is controlled to move along a path that ensures contact with some rigid structures in the environment.
## Prerequisites
* [scikit-learn](https://scikit-learn.org/stable/) Python-based machine leraning library
* [MuJoCo](http://www.mujoco.org/) simulator - requires license (optional: only for YuMi simulation)

## Instructions and files info
### Blocks experiment
#### How to run:
* blocks_exp.py -  Run this to generate and save data from this experiment
* model_learning_preprocessing.py - Run this to preprocess the data generated by blocks_exp.py
* model_learning_core.py - Run this to execute the model learning algorithm in the preprocessed data

### YuMi experiment
#### How to run:  
* yumi_exp_data_extraction.py - Run this to extract data from an experiment run by the Berkeley robot control (BRC) system. Not advised to do this without setting up the BRC system. Go to the next step. 
* model_learning_preprocessing_yumi.py - Run this to preprocess the extracted data.
* model_learning_core_yumi.py - Run this to execute the model learning algorithm on the real robot experiment data.

### Support files:
* blocks_sim.py -  Implementation of blocks simulation
* model_learning_utils - Common classes and methods for both experiments
* multidim_gp.py - A wrapper for Scikit-learn Gaussian Process Regression to expand it to multi output cases.

### Directory structure:
* Archive - Unused old code
* Plots - Generated plots
* Results - Generated log and data files
* Tests - All test cases for python unittest.